version: '4'

services:
  db:
    image: mysql:latest
    container_name: db
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: db
      MYSQL_USER: user
      MYSQL_PASSWORD: user
    ports:
      - "3308:3306"
    volumes:
      - ./db:/var/lib/mysql
    # healthcheck:
    #   test: ["CMD", "mysqladmin", "ping", "-h", "localhost", "-u", "root", "-p root"]
    #   interval: 5s
    #   retries: 3

#   server: 
#     build:
#       dockerfile: Dockerfile
#       context: ./src/server
#     ports:
#       - "8080:8080"
#     environment:
#       - SPRING_DATASOURCE_URL=jdbc:mysql://db:3308/db
#       - SPRING_DATASOURCE_USERNAME=root
#       - SPRING_DATASOURCE_PASSWORD=root
#       - SPRING_DATASOURCE_DRIVER-CLASS-NAME=com.mysql.cj.jdbc.Driver
#       - SPRING_JPA_HIBERNATE_DDL-AUTO=update
#     volumes:
#       - ./src/server:/app
#     networks:
#       - mynet
#     depends_on:
#       db:
#         condition: service_healthy

#   client:
#     build:
#       dockerfile: Dockerfile
#       context: ./src/client
#     ports:
#       - "3000:3000"
#     volumes:
#       - /app/node_modules
#       - ./src/client:/app
#     networks:
#       - mynet
#     depends_on:
#       - server

# networks:
#   mynet:
#     driver: bridge